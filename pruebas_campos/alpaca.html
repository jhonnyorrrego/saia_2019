<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8" />
<title>Empezando con Alpaca</title>
<link rel="stylesheet" type="text/css"
	href="alpaca-master/lib/bootstrap/dist/css/bootstrap.min.css" />
<style>
.alpaca-icon-required::before {
    content: "*"
}
</style>
<script>
//var palabras = ["y", "o", "e", "u", "el", "la", "los", "las", "un", "uno", "una", "unos", "unas", "lo", "al", "del", "a", "de", "en", "con"];

var palabras = ["y", "o", "e", "u", "lo", "al", "del", "a", "de", "en", "con"
];

function recortar(palabras, numLetras=22, union='_') {
	var txt = palabras.join(union);
	var minsize=3;
	var longitud = palabras.length;
	var i = 0;
	var maximo = txt.length;
	if(maximo <= numLetras) {
		return txt;
	}
	for (var iteraciones = 0; iteraciones < maximo; iteraciones++) {
		if(palabras[i].length > minsize) {
			palabras[i] = palabras[i].slice(0,-1);
		}
		if(palabras.join(" ").length <= numLetras) {
			break;
		}
		i++;
		if(i >= longitud) {
			i = 0;
		}
	}
	var resp = palabras.join(union);
	if(resp.length > numLetras) {
		resp = resp.slice(0, numLetras);
	}
	return resp;
} // end funcion

var normalizar = (function() {
	  var from = "ÃÀÁÄÂÈÉËÊÌÍÏÎÒÓÖÔÙÚÜÛãàáäâèéëêìíïîòóöôùúüûÑñÇç", 
	      to   = "AAAAAEEEEIIIIOOOOUUUUaaaaaeeeeiiiioooouuuuNncc",
	      mapping = {};
	 
	  for(var i = 0, j = from.length; i < j; i++ ) {
	      mapping[from.charAt(i)] = to.charAt(i);
	  }
	  return function(str) {
	      var ret = [];
	      for(var i = 0, j = str.length; i < j; i++) {
	          var c = str.charAt(i);
	          if(mapping.hasOwnProperty(str.charAt(i))) {
	              ret.push(mapping[c]);
	          }  else {
	              ret.push(c);
	          }
	      }
	      // replace(/\s+/g, '_' )
	      var normal = ret.join('').toLowerCase().replace(/[^a-z0-9\s]+/g, '');
	      var cadenas = normal.split(/\s+/);
	      var resp = [];
	      for(var i = 0, j = cadenas.length; i < j; i++) {
	    	  var index = palabras.indexOf(cadenas[i]);
	    	  if (index === -1) {
	    		  resp.push(cadenas[i]);
	    	  }
	      }
	      return recortar(resp, 22, '_');
	  }
	 
	})();
</script>
<!-- 	<script type="text/javascript" src="../js/jquery/3.3.1/jquery.min.js"></script> -->
<!-- jQuery -->
	<script type="text/javascript" src="alpaca-master/lib/jquery/dist/jquery.min.js"></script>

<!-- 	<script type="text/javascript" src="../assets/theme/assets/plugins/bootstrap/js/bootstrap.min.js"></script> -->

<!-- Bootstrap -->
    <script type="text/javascript" src="alpaca-master/lib/bootstrap/dist/js/bootstrap.js"></script>

    <!-- handlebars -->
    <script type="text/javascript" src="js/handlebars.js"></script>

    <!-- alpaca -->
    <link type="text/css" href="js/alpaca.min.css" rel="stylesheet" />
    <script type="text/javascript" src="js/alpaca.min.js"></script>

<!-- jQuery UI Support -->
<script type="text/javascript" src="alpaca-master/lib/jquery-ui/jquery-ui.js"></script>
<link type="text/css" href="alpaca-master/lib/jquery-ui/themes/cupertino/jquery-ui.min.css" rel="stylesheet"/>

<!-- Required for jQuery UI DateTimePicker control -->
<script type="text/javascript" src="alpaca-master/lib/jqueryui-timepicker-addon/dist/jquery-ui-timepicker-addon.js"></script>
<link type="text/css" href="alpaca-master/lib/jqueryui-timepicker-addon/dist/jquery-ui-timepicker-addon.css" rel="stylesheet"/>

<!-- Required for Text Field masking -->
<script type="text/javascript" src="alpaca-master/lib/jquery-maskedinput/dist/jquery.maskedinput.min.js"></script>

<!-- bootstrap datetimepicker for date, time and datetime controls -->
<script src="alpaca-master/lib/moment/min/moment-with-locales.min.js"></script>
<script src="alpaca-master/lib/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>
<link rel="stylesheet" media="screen" href="alpaca-master/lib/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.css"/>

<!-- bootstrap-multiselect for time field -->
<script src="alpaca-master/lib/bootstrap-multiselect/js/bootstrap-multiselect.js"></script>
<link rel="stylesheet" media="screen" href="alpaca-master/lib/bootstrap-multiselect/css/bootstrap-multiselect.css"/>

</head>

<body>
	<h1>Empezando con Alpaca</h1>
	<div id="editar_pantalla_campo" name="editar_pantalla_campo"></div>
	<div id="res" class="alert"></div>
	<script type="text/javascript">
		$('#editar_pantalla_campo').alpaca({
			schema: {
                "description":"What do you think about Alpaca?",
                "type":"object",
				properties: {
					fs_etiqueta: {
						type: "string",
						title: "Etiqueta del campo",
						maxLength: 255,
						required: true
					},
					fs_lista_items: {
						"type": "array",
				        "items": {
				            "item": "Helado",
				            "type": "string",
				            "minLength": 3,
				            "maxLength": 8
				        }
					},
					fs_fecha: {
						format: "date"
					},
					fs_nombre: {
						type: 'string',
						title: 'Nombre',
						maxLength: 255,
						required: true
					},
					fs_acciones: {
						type: "string",
						title: "Incluirse en la descripción del formato",
						enum: ["", "p"]
					},
					fs_obligatoriedad: {
					    "type": "string",
					    "title": "Obligatoriedad",
					    "enum": ["1", "0"]
					},
					fs_valor: {
						type: "object",
						title: "Configuración",
						properties: {
							url : {
								title: "Tipo",
								type: "string",
								enum: [
							        "funcionario",
							        "dependencia",
							        "cargo", "serie"
							    ]
							}
						}
					}
				}
			},
			options: {
				fields: {
					fs_etiqueta : {
						events: {
							change: function (evt) {
						        var value = $(evt.target).val();
						        if (value) {
						        	value = normalizar(value);
						        	$("[name='fs_nombre']").val(value);
						        }
						    }		
						}
					},
					fs_lista_items: {
				        "toolbarSticky": true,
				        "toolbarPosition": "bottom",
			            "fields": {
			                "item": {
			                    "label": "Item",
			                }
			            }
					},
					fs_fecha: {
				        "label": "Por favor, elige una fecha para su visita:",
						type: "date",
						"dateFormat": "YYYY/MM/DD",
						"manualEntry": true
					},
					fs_obligatoriedad : {
						type: "radio",
						removeDefaultNone: true,
						optionLabels: [
					        "No obligatrio",
					        "Obligatorio"
						],
					},
					fs_acciones : {
						removeDefaultNone: true,
						type: "radio",
						vertical: false,
						optionLabels: [
					        "No incluirse",
					        "Incluirse"
						],
					},
					"fs_valor" : {
						fields : {
							"url" : {
								sort: false,
								removeDefaultNone: true,
								optionLabels: [
							        "Funcionario",
							        "Dependencia",
								    "Cargo",
									"Serie"
								]
							}
						}
					} 
				},
				form: {
					buttons: {
						enviar : {
							"title": "Enviar",
			                "click": function() {
			                    this.refreshValidationState(true);
			                    if (this.isValid(true)) {
			                        var value = this.getValue();
			                        alert(JSON.stringify(value, null, "  "));
			                    }
			        		}
						}
					}
				}				
			},
			"view": {
		        "locale": "es_ES"
		    }
		});
		
		
	</script>
</body>

</html>