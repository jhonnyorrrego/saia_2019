<?php
include_once('../librerias/estilo_formulario.php');
include_once('../../db.php');
$formato=busca_filtro_tabla("","formato","nombre_tabla LIKE 'ft_riesgos_proceso'","",$conn);
?>
<?php include ("../../header.php") ?>
<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../anexosdigitales/highslide-4.0.10/highslide/highslide-with-html.js"></script>
<link rel="stylesheet" type="text/css" href="../../anexosdigitales/highslide-4.0.10/highslide/highslide.css" />
<script type='text/javascript'>
    hs.graphicsDir = '../../anexosdigitales/highslide-4.0.10/highslide/graphics/';
    hs.outlineType = 'rounded-white';
</script>
<p>
<table border="1" width="100%" cellspacing="0" class="tabla_borde">
<tbody>
<tr>
<td  style=" border: windowtext 0.5pt solid; " rowspan="3">PROBABILIDAD</td>
<td  style=" border: windowtext 0.5pt solid; text-align: center;">Alta<br />(3)</td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #e8db3f;">
<p>Riesgo Moderado<br /><?php echo(cuadrante(1,3)); ?></p>
</td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #f13f2c;">&nbsp;Riesgo Intolerable<br /><?php echo(cuadrante(2,3)); ?></td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #f13f2c;">
<p>&nbsp;Riesgo Intolerable<br /><?php echo(cuadrante(3,3)); ?></p>
</td>
</tr>
<tr>
<td  style=" border: windowtext 0.5pt solid; text-align: center;">Media<br />(2)</td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #71cc1e;">Riesgo Tolerable<br /><?php echo(cuadrante(1,2)); ?></td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #e8db3f;">Riesgo Moderado<br /><?php echo(cuadrante(2,2)); ?></td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #f13f2c;">&nbsp;Riesgo Intolerable<br /><?php echo(cuadrante(2,3)); ?></td>
</tr>
<tr>
<td  style=" border: windowtext 0.5pt solid; text-align: center;">Baja<br />(1)</td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #71cc1e;">Riesgo Tolerable<br /><?php echo(cuadrante(1,1)); ?></td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #71cc1e;">Riesgo Tolerable<br /><?php echo(cuadrante(2,1)); ?></td>
<td  style=" border: windowtext 0.5pt solid; border: 0.5pt solid windowtext; text-align: center; background-color: #e8db3f;">Riesgo Moderado<br /><?php echo(cuadrante(3,1)); ?></td>
</tr>
<tr>
<td  style=" border: windowtext 0.5pt solid; " rowspan="2">&nbsp;</td>
<td  style=" border: windowtext 0.5pt solid; ">&nbsp;</td>
<td  style=" border: windowtext 0.5pt solid; text-align: center;">Ligeramente Da&ntilde;ino<br />(1)</td>
<td  style=" border: windowtext 0.5pt solid; text-align: center;">Da&ntilde;ino<br />(2)</td>
<td  style=" border: windowtext 0.5pt solid; text-align: center;">Extremadamente Da&ntilde;ino<br />(3)</td>
</tr>
<tr>
<td  style=" border: windowtext 0.5pt solid; ">&nbsp;</td>
<td  style=" border: windowtext 0.5pt solid; text-align: center;" colspan="3">IMPACTO</td>
</tr>
</tbody>
</table>
</p>
<p>&nbsp;</p>
</p>
<?php
function cuadrante($impacto,$probabilidad){
global $conn,$formato;
$texto="";
$riesgos=busca_filtro_tabla("","ft_riesgos_proceso","impacto=".$impacto." AND probabilidad=".$probabilidad,"",$conn);
for($i=0;$i<$riesgos["numcampos"];$i++){
  $seguimientos=busca_filtro_tabla("","ft_seguimiento_riesgo","ft_riesgos_proceso=".$riesgos[$i]["idft_riesgos_proceso"],"",$conn);
  $texto.='<a href="mostrar_riesgos_proceso.php?idformato='.$formato[0]["idformato"].'&iddoc='.$riesgos[$i]["idft_riesgos_proceso"].'" class="highslide" onclick="return hs.htmlExpand(this, { objectType: '."'iframe'".',width: 550, height:400,preserveContent:false } )" style="text-decoration: underline; cursor:pointer;">'.strip_tags($riesgos[0]["actividad"]).'</a>&nbsp;&nbsp;';
  if($seguimientos["numcampos"]){
    $texto.='<a href="listado_seguimientos_riesgos_proceso.php?idriesgo='.$riesgos[$i]["idft_riesgos_proceso"].'" class="highslide" onclick="return hs.htmlExpand(this, { objectType: '."'iframe'".',width: 550, height:400,preserveContent:false } )" style="text-decoration: underline; cursor:pointer;">Seg</a><br />';
  }
}
return($texto);
}
include_once("../../footer.php");
?>